#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
# 0.1.6
# Alexey Potehin http://www.gnuplanet.ru/doc/cv
#
# git clone git://github.com/progman/gitbash.git ~/.gitbash.git
# echo "source ~/.gitbash.git/.gitbash" >> ~/.bashrc
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
function git_merge()
{
    if [ "${1}" == "" ];
    then
	echo "error: missing branch name";
	return;
    fi
    echo "git merge --no-ff ${1} -m 'merge branch \"${1}\"'";
    git merge --no-ff ${1} -m "merge branch \"${1}\"";
}
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
function get_git_branch()
{
    FLAG_COLOR='false';

    if [ "$(which git)" != "" ] && [ "$(which grep)" != "" ] && [ "$(which sed)" != "" ];
    then
	BRANCH="$(git branch 2>/dev/null | grep '^\*' | sed -e 's/^\*\ //g')";
	if [ "${BRANCH}" != "" ];
	then
	    if [ "$(git status --porcelain --ignore-submodules | grep -v '^??' | grep -v '^AD' | wc -l)" != "0" ];
	    then
		GIT_UNCOMMITED="(+)";
	    fi
	    if [ "${FLAG_COLOR}" != "false" ];
	    then
		echo -en "\033[32m";
	    fi
	    echo -en "[${GIT_UNCOMMITED}git::${BRANCH}]";
	    if [ "${FLAG_COLOR}" != "false" ];
	    then
		echo -en "\033[0m";
	    fi
	    echo -en " ";
	fi
    fi
}
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
if [ "${USER}" == "root" ];
then
    export PS1='$(get_git_branch)\u@\h:\w# ';
else
    export PS1='$(get_git_branch)\u@\h:\w$ ';
fi
#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
